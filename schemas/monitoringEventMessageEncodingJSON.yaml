$schema: https://json-schema.org/draft/2020-12/schema
$id: https://schemas.wmo.int/wme/1/eventMessageEncodingJSON.yaml
title: WIS2 Event Message Encoding
description: WIS2 Event Message Encoding

allOf:
  - $ref: 'cloudevents-v1.0.2.yaml'
  - properties:
      type:
        type: string
        enum:
          - int.wmo.wis.wme.event
      data:    
        properties:
          conformsTo:
            type: array
            contains:
                const: http://wis.wmo.int/spec/wme/1/conf/monitoring-event-message-encoding-core
          severity:
            type: string
            description: Severity level
            enum:
              - DEBUG
              - INFO
              - WARNING
              - ERROR
              - CRITICAL
          ref:
            type: string
            format: uuid
            description: Identifier of referenced event
          time:
            type: object
            description: Time instant or interval
            $ref: 'https://raw.githubusercontent.com/wmo-im/wcmp2/refs/heads/FT2025-2/schemas/wcmpRecordGeoJSON.yaml#/properties/time'
          content:
            type: object
            description: inline content of event message
            properties:
              channel:
                type: string
                description: topic that link is based on
              title:
                $ref: 'https://schemas.opengis.net/ogcapi/records/part1/1.0/openapi/schemas/recordCommonProperties.yaml#/properties/title'
              description:
                $ref: 'https://schemas.opengis.net/ogcapi/records/part1/1.0/openapi/schemas/recordCommonProperties.yaml#/properties/description'
            required:
              - title
          links:
            type: array
            $ref: 'https://raw.githubusercontent.com/wmo-im/wcmp2/refs/heads/main/schemas/wcmpRecordGeoJSON.yaml#/properties/links'
        anyOf:
          - required:
              - conformsTo
              - severity
              - content
          - required:
              - conformsTo
              - severity
              - links

    required:
      - datacontenttype
      - dataschema
      - subject
      - time
      - data
